"use strict";(()=>{var l=Object.defineProperty,I=Object.defineProperties;var h=Object.getOwnPropertyDescriptors;var p=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable;var u=(e,n,a)=>n in e?l(e,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[n]=a,r=(e,n)=>{for(var a in n||(n={}))E.call(n,a)&&u(e,a,n[a]);if(p)for(var a of p(n))C.call(n,a)&&u(e,a,n[a]);return e},m=(e,n)=>I(e,h(n));var o=(e,n,a)=>new Promise((s,i)=>{var d=t=>{try{g(a.next(t))}catch(c){i(c)}},f=t=>{try{g(a.throw(t))}catch(c){i(c)}},g=t=>t.done?s(t.value):Promise.resolve(t.value).then(d,f);g((a=a.apply(e,n)).next())});var T="X Channel Audiences",w="AW-789859065",_=()=>o(void 0,null,function*(){var e;window.addEventListener("message",n=>o(void 0,null,function*(){yield y(n.data)})),(e=window==null?void 0:window.triptease)!=null&&e.config&&(yield y(window.triptease.config))}),$=e=>e.reduce((n,[a,s])=>m(r({},n),{[a]:s}),{});function y(e){return o(this,null,function*(){var n,a;try{if(e.anonymousId||(n=e.anonymousIds)!=null&&n.length){j();let s=yield v(e),i=r({send_to:w,event:(a=e.payload)==null?void 0:a.type,user_id:e.anonymousId},$(s.map(d=>[`aud_${d}`,"1"])));window.gtag("event","page_view",i)}}catch(s){window.postMessage({type:"triptease.logs",level:"error",context:{app:{name:T,version:"48a7985aaaf42e438be1ef288e5a69f8fcc3c042"}},payload:r({messageId:e.messageId},s instanceof Error?{errorMessage:s.message,errorName:s.name,errorStack:s.stack}:{errorMessage:`Unknown error ${s}`})},"*")}})}function j(){if(!window.gtag){let e=window.document.createElement("script");e.async=!0,e.src=`https://www.googletagmanager.com/gtag/js?id=${w}`,window.document.head.appendChild(e),window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},window.gtag("js",new Date),window.gtag("config",w,{send_page_view:!1})}}function v(e){return o(this,null,function*(){let n=e.anonymousIds?[...e.anonymousIds].slice(0,10):[];e.anonymousId&&!n.includes(e.anonymousId)&&n.push(e.anonymousId);let a=yield fetch(`https://api.audiences.triptease.io/segments?ids=${n.join(",")}`);if(!a.ok)throw new Error(`Error fetching audiences: ${a.status} - ${yield a.text()}`);return a.json()})}_();})();
//# sourceMappingURL=index.js.map
