/**
 * Stackla is made available under a commercial licence
 * and is subject to Stackla's Terms of Service.
 *
 * Refer to https://stackla.com/terms-of-service/ 
 * or contact support@nosto.com for further clarification.
 *
 * Built on 2025-04-23 04:04:59
 */
(()=>{var a,e,t=$(document);window.Stackla&&window.Stackla.Trackla||(a={tileVote:"vote",tileComment:"comment",tileLike:"like",tileShare:"share"},(e=function(e){var t,n=this;for(t in n.events=[],n.tileImpressions=[],n.trackingMethod="realtime",n.writeFrequency=1e4,e)e.hasOwnProperty(t)&&(n[t]=e[t]);n.init()}).prototype.init=function(){var e=this;t.on("tileVote",e.handleEvents.bind(e)),t.on("tileComment",e.handleEvents.bind(e)),t.on("tileLike",e.handleEvents.bind(e)),t.on("tileShare",e.handleEvents.bind(e)),t.on("tileExpand",e.handleEvents.bind(e)),t.on("tileClick",e.handleEvents.bind(e)),t.on("tilesAppend",e.handleEvents.bind(e)),t.on("tilesReappear",e.handleEvents.bind(e)),t.on("load",e.handleEvents.bind(e)),"interval"===e.trackingMethod&&e.writeFrequency&&setInterval(e.writeToTrackla.bind(e),e.writeFrequency)},e.prototype.addEvent=function(e,t,n,i){this.events.push({category:e,action:t,label:n,value:i})},e.prototype.handleAppend=function(e,t,n){var i=this,a=[];(n=void 0===n?!0:n)||(i.tileImpressions.length=0),t&&t.length&&(t.map(function(e){var t=i.getTileId(e);t&&-1===$.inArray(t,i.tileImpressions)&&(i.addEvent("tile","view","",t),i.tileImpressions.push(t),a.push(e))}),a.map(function(e){e.tags&&e.tags.length&&e.tags.map(function(e){i.addEvent("tag","view","",e)})}))},e.prototype.handleClick=function(e,t){var n=this,i=n.getTileId(t);i&&(n.addEvent("tile","click","",i),t.tags)&&t.tags.length&&t.tags.map(function(e){n.addEvent("tag","click","",e)})},e.prototype.handleInteractions=function(e,t){t=this.getTileId(t);t&&this.addEvent("tile",e,"",t)},e.prototype.handleLoad=function(e,t){t&&t.id&&(this.addEvent("widget","view","",t.id),this.addEvent("parent","load","",{widget_id:t.id,parent_page_url:document.referrer}))},e.prototype.writeToTrackla=function(){var e=this,t=JSON.stringify({stackId:e.stackId,page:window.location.href,events:e.events});e.tracklaEndPoint&&e.stackId&&e.events.length&&(e.events.length=0,$.ajax({url:e.tracklaEndPoint,contentType:"application/json; charset=utf-8",type:"POST",dataType:"json",data:t}))},e.prototype.handleEvents=function(e,t){var n=this,i=e&&e.type||"";switch(i){case"tileClick":case"tileExpand":n.handleClick(i,t);break;case"tilesReappear":n.handleAppend(i,t,!1);break;case"tilesAppend":n.handleAppend(i,t);break;case"load":n.handleLoad(i,t);break;case"tileVote":case"tileLike":case"tileComment":case"tileShare":n.handleInteractions(a[i],t)}"realtime"===n.trackingMethod&&(clearTimeout(n.delayWriteToTrackla),n.delayWriteToTrackla=setTimeout(n.writeToTrackla.bind(n),500))},e.prototype.getTileId=function(e){if(e&&e._id){if("object"==typeof e._id&&e._id.$id)return e._id.$id;if("string"==typeof e._id)return e._id}return null},window.Stackla=window.Stackla||{},window.Stackla.Trackla=e)})();